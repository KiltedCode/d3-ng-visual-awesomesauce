<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>Visual Awesomesauce</title>

		<link rel="stylesheet" href="node_modules/reveal.js/css/reveal.css">
		<link rel="stylesheet" href="node_modules/reveal.js/css/theme/league.css">
		<link rel="stylesheet" href="styles.css">

		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="node_modules/reveal.js/lib/css/zenburn.css">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'node_modules/reveal.js/css/print/pdf.css' : 'node_modules/reveal.js/css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>
	</head>
	<body>
		<div class="reveal">
			<div class="slides">

                <section id="title" data-background="/assets/img/blueprint.jpg">
                    <div class="bg-img">
                    <h1 class="bg-img">D3 + Angular</h1>
                    <h2 class="bg-img">Visual Awesomesauce</h2>
                    <p class="">
                        John Niedzwiecki
                    </p>
                    </div>
                    <aside class="notes">
                        Photo by Daniel McCullough on Unsplash
                        https://unsplash.com/photos/-FPFq_trr2Y?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText
                    </aside>
                </section>

                <section id="about-me">
                    <h2>About the Geek</h2>
                    <pre class="small-code"><code>function getDeveloperInfo() {
    let dev = {
        name: 'John Niedzwiecki',
        desc: 'Your friendly neighborhood kilted coder.',
        company: 'VIPRE Security',
        role: 'Lead Software Engineer - UI',
        twitter: '@rhgeek',
        github: 'rhgeek',
        web: 'https://rhgeek.github.io',
        email: 'john.niedzwiecki.ii@gmail.com',
        currentDevLoves: ['Angular', 'JavaScript Everywhere', 'd3', 'CSS instead of JS'],
        nonDevAttr : {
            isHusband: true,
            isFather: true,
            hobbies: ['running', 'disney', 'cooking', 'video games', 'photography'],
            twitter: '@rgrdisney',
            web: 'http://www.rungeekrundisney.com',
        }
    };
    return dev;
}</code></pre>
                </section>

                <section id="abstract">
                    <h1>The World is Data</h1>
                    <aside class="notes">
                            The world is data. We gather it everywhere: forms, feedback, learning techniques, data mining. 
                            When it comes to working with that data, we need to do more than show numbers back to our users. 
                            With the combination of D3 and Angular, we can take that data and create versatile and interactive visualizations that respond to dynamic data. 
                            In this talk, weâ€™ll look at how to create visualizations of data with D3 combined with Angular Components. 
                            This combination is where you squeeze that last 10% out of your data and take your data based application to the next step for your users.
                    </aside>
                </section>

                <section id="outline">
                    <h2>What We'll Do</h2>
                    <ul>
                        <li>What is D3?</li>
                        <li>General Update Pattern</li>
                        <li>What is Angular?</li>
                        <li>Combine D3 + Angular</li>
                    </ul>
                </section>

                <section id="topic-d3">
                    <section id="what-is-d3-title">
                        <h1 class="section-title"><img src="/assets/img/d3.png" class="no-style inline-header-logo" alt="D3" title="D3" /> What is D3?</h1>
                    </section>

                    <section id="what-is-d3">
                        <h2><img src="/assets/img/d3.png" class="no-style inline-header-logo" alt="D3" title="D3" /> What is D3?</h2>
                        <p>
                            Open source JavaScript library that provides powerful manipulation of the Document Object Model (DOM) driven by data.
                        </p>
                        <p class="text-right">
                            <a href="https://github.com/d3/d3"><small>https://github.com/d3/d3</small></a>
                        </p>
                        <aside class="notes">
                            D3 (or D3.js) is a JavaScript library for visualizing data using web standards. D3 helps you bring data to life using SVG, Canvas and HTML. 
                            D3 combines powerful visualization and interaction techniques with a data-driven approach to DOM manipulation, giving you the full capabilities of modern browsers and the freedom to design the right visual interface for your data.
                        </aside>
                    </section>

                    <section id="d3-gons">
                        <h2>Creating Shapes</h2>
                        <p>
                            Easy to create whatever shapes you want.
                        </p>
                    </section>

                    <section id="d3-gons-pentagon">
                        <h2>Creating Shapes: Pentagon</h2>
                        <p><a href="https://codepen.io/rhgeek/pen/qPoWwB/">https://codepen.io/rhgeek/pen/qPoWwB/</a></p>
                    </section>
                    
                    <section id="d3-gons-hexagon">
                        <h2>Creating Shapes: Hexagon</h2>
                        <p><a href="https://codepen.io/rhgeek/pen/MEVgRz">https://codepen.io/rhgeek/pen/MEVgRz</a></p>
                    </section>
                    
                    <section id="d3-gons-pentagon">
                        <h2>Creating Shapes: Arc</h2>
                        <p><a href="https://codepen.io/rhgeek/pen/NaYKZy">https://codepen.io/rhgeek/pen/NaYKZy</a></p>
                    </section>
                    
                    <section id="d3-gons-output">
                        <h2>Creating All the 'Gons'</h2>
                        <img src="/assets/img/the-gons.png" alt="Gons Output" />
                        <p class="text-right">
                            <a href="https://github.com/RHGeek/d3-ng-visual-awesomesauce/tree/master/examples/all-the-gons"><small>d3-ng-visual-awesomesauce / examples / all-the-gons</small></a>
                        </p>
                    </section>



                    <section id="d3-ex">
                        <h2>Example</h2>
                        <p>
                            Let's do more than your normal "draw a line" tutorial.
                        </p>
                    </section>

                    <section id="d3-easy">
                        <h2>Easy as SVG</h2>
                        <p>
                            Getting started is as easy as SVG
                        </p>
<pre><code data-trim>
var width = 500,
    height = 500;
var svg = d3.select('body')
    .append('svg')
        .attr('width', width)
        .attr('height', height)
    .append('g')
        .attr('transform', 'translate(' + width / 2 + ',' + height / 2 + ')');    
</code></pre>
                    </section>

                    <section id="d3-arc">
                        <h2>Let's get functional </h2>
                        <p>
                            Power by defining a function to use with data. In our case arc.
                        </p>
<pre>
<code data-trim>
var xScale = d3.scaleLinear()
    .range([0, 2 * Math.PI]);
var yScale = d3.scaleSqrt()
    .range([0, radius]);

var arc = d3.arc()
    .startAngle(function(d) { return Math.max(0, Math.min(2 * Math.PI, xScale(d['x0']))); })
    .endAngle(function(d) { return Math.max(0, Math.min(2 * Math.PI, xScale(d['x1']))); })
    .innerRadius(function(d) { return Math.max(0, yScale(d['y0'])); })
    .outerRadius(function(d) { return Math.max(0, yScale(d['y1'])); });
</code>
</pre>
                    </section>

                    <section id="d3-data">
                        <h2>Bring on the data!</h2>
                    </section>

                </section>

                <section id="topic-gup">
                    <section id="gup-title">
                        <h1 class="section-title">General Update Pattern</h1>
                    </section>

                    <section id="gup">
                        <h2>General Update Pattern</h2>
                        <p>
                            D3 has a pattern for how to deal with your data.
                        </p>
                        <ul>
                            <li>join: <code>data()</code></li>
                            <li>enter: <code>append()</code></li>
                            <li>update: <code>transition()</code></li>
                            <li>exit: <code>exit()</code></li>
                        </ul>
                    </section>

                    <section id="gup-code">
                            <h2>General Update Pattern</h2>
<pre><code data-trim>
root = d3.hierarchy(tree);
root.sum(function(d) { return d.size; });

/* JOIN new data with old elements */
var path = svg.selectAll('path')
    .data(partition(root).descendants());

/* ENTER new elements present in new data */
/* UPDATE old elements present in new data */
path.enter()
    .append('path')
        .on('mouseover', mouseoverArc)
        .on('mousemove', mousemoveArc)
        .on('mouseout',  mouseoutArc)
        .on('click',     clickArc)
    .merge(path)      // ENTER + UPDATE
        .transition().duration(500)
        .attr('d', arc)
        .style('stroke', '#ffffff')
        .style('fill', function(d) { return color((d.children ? d : d.parent).data.name); })
        .style('cursor', function(d) { return d.data.level == 'parkName' || d.data.level == 'type' ? 'pointer' : 'auto' });
    
/* EXIT old elements not present in new data */
path.exit()
    .transition()
    .duration(500)
    .remove();
</code></pre>
                        </section>

                </section>

                <section id="topic-ng">
                    <section id="what-is-ng-title">
                        <h1 class="section-title"><img src="/assets/img/angular.png" class="no-style inline-header-logo" alt="NG" title="Angular" /> What is Angular?</h1>
                    </section>

                    <section id="what-is-ng">
                        <h2><img src="/assets/img/angular.png" class="no-style inline-header-logo" alt="NG" title="Angular" /> What is Angular?</h2>
                        <blockquote cite="https://github.com/angular/angular">
                            &ldquo;Angular is a development platform for building mobile and desktop web applications.&rdquo;
                        </blockquote>
                        <p class="text-right">
                            <a href="https://github.com/angular/angular"><small>https://github.com/angular/angular</small></a>
                        </p>
                        <aside class="notes">
                            Opinionated framework for building SPA. Centered around web components, but gives you everything you need for the full application.<br />
                            Align with latest web standards, simple, fast, work for mobile (and beyond IoT nuero)
                        </aside>
                    </section>
                    
                    <section id="ng-key-pieces">
                        <h2>Key Pieces of Angular</h2>
                        <ul>
                            <li>Components</li>
                            <li>Services</li>
                            <li>Router</li>
                            <li>Pipes</li>
                            <li>Modules</li>
                        </ul>
                    </section>

                    <section id="ng-components">
                        <h2>Angular Components</h2>
                        <p>
                            Angular components are your base building block for your UI. 
                            In the end, your Angular application is a tree of components, so, yeah, theyâ€™re pretty important.
                        </p>
                    </section>

                </section>
                
                <section id="topic-powers-combined">
                    <section id="powers-combined-title">
                        <h1 class="section-title"><img src="/assets/img/cp.png" class="no-style inline-header-logo" alt="CP" title="Captain Planet" /> With our powers combined...</h1>
                    </section>

                    <section id="powers-combined">
                        <h2><img src="/assets/img/cp.png" class="no-style inline-header-logo" alt="CP" title="Captain Planet" /> With our powers combined...</h2>
                        <p>
                            Together we can create visual awesomesauce!
                        </p>
                        <img src="/assets/img/sunburst.png" alt="Sunburst" class="sunburst-output" />
                    </section>
                    
                    <section id="powers-getting-d3">
                        <h2>Add D3 to our Angular Application</h2>
                        <p class="text-left">
                            Install dependencies:<br />
                            <code class="indent">npm install --save d3</code><br />
                            <code class="indent">npm install --save-dev @types/d3</code>
                        </p>
                        <p class="text-left">
                            Import in our component:<br />
                            <code class="indent">import * as d3 from 'd3';</code>
                        </p>
                    </section>
                    
                    <section id="powers-restructure">
                        <h2>Restructure our D3 code within the component</h2>
                        <ul>
                            <li>Create variables</li>
                            <li>Setup in <code>ngOnInit</code></li>
                            <li>Move chart creating into own function</li>
                        </ul>
                    </section>

                    <section id="powers-restructure-ngoninit">
                        <h2>Restructure: ngOnInit</h2>
<pre><code data-trim>
ngOnInit() {
    this.created = false;
    this.attractionTree = {
        name : 'Theme Parks',
        children : []
    };
    this.margin = 10;
    this.createChart();
    this.updateChart(this.attractionTree);
}
</code></pre>
                    </section>

                    <section id="powers-restructure-chart">
                        <h2>Restructure: Create Chart</h2>
<pre><code data-trim>
@ViewChild('chart') 
private chartContainer: ElementRef;

private createChart(): void {
    let element = this.chartContainer.nativeElement;
    this.width = element.offsetWidth - this.margin * 2;
    this.height = element.offsetHeight - this.margin * 2;
    this.radius = (Math.min(this.width, this.height) / 2) - this.margin * 2
    
    /* create svg */
    this.svg = d3.select(element).append('svg')
        .attr('width', element.offsetWidth)
        .attr('height', element.offsetHeight)
        .append('g')
        .attr('transform', 'translate(' + this.width / 2 + ',' + this.height / 2 + ') rotate(-90 0 0)');
    
    /* create tooltip div */
    this.tooltip = d3.select(element)
        .append('div')
        .attr('id', 'tooltip')
        .style('position', 'absolute')
        .style('z-index', '10')
        .style('opacity', 0)
        .style('background-color', 'rgba(255, 255, 255, 0.6)')
        .style('padding', '5px 10px');

    /* set up scales */
    this.xScale = d3.scaleLinear()
        .range([0, 2 * Math.PI]);
    this.yScale = d3.scaleSqrt()
        .range([0, this.radius]);
    this.color = d3.scaleOrdinal(d3.schemeCategory20c);

    /* layout */
    this.partition = d3.partition();

    /* arc function for calculating slices of sunburst */
    this.arc = d3.arc()
        .startAngle((d: any) => { return Math.max(0, Math.min(2 * Math.PI, this.xScale(d['x0']))); })
        .endAngle((d: any) => { return Math.max(0, Math.min(2 * Math.PI, this.xScale(d['x1']))); })
        .innerRadius((d: any) => { return Math.max(0, this.yScale(d['y0'])); })
        .outerRadius((d: any) => { return Math.max(0, this.yScale(d['y1'])); });

    this.created = true;
}
</code></pre>
                    </section>

                    <section id="powers-restructure-chart">
                        <h2>Restructure: Update Chart</h2>
<pre><code data-trim>
private updateChart(tree: any): void {
    this.root = d3.hierarchy(tree);
    this.root.sum(function(d) { return d.size; });

    /* JOIN new data with old elements */
    let path = this.svg.selectAll('path')
        .data(this.partition(this.root).descendants());

    /* ENTER new elements present in new data */
    /* UPDATE old elements present in new data */
    path.enter()
        .append('path')
        .on('mouseover', (d) => this.mouseoverArc(d))
        .on('mousemove', (d) => this.mousemoveArc())
        .on('mouseout',  (d) => this.mouseoutArc())
        .on('click',     (d) => this.clickArc(d))
        .merge(path)      // ENTER + UPDATE
        .transition().duration(500)
        .attr('d', this.arc)
        .style('stroke', '#ffffff')
        .style('fill', (d: any) => { return this.color((d.children ? d : d.parent).data.name); })
        .style('cursor', (d: any) => { return d.data.level == 'parkName' || d.data.level == 'type' ? 'pointer' : 'auto' });
        
    /* EXIT old elements not present in new data */
    path.exit()
        .transition()
        .duration(500)
        .remove();
}
</code></pre>
                    </section>

                    <section id="powers-input-output">
                        <h2>Communicate Between Components</h2>

                        <ul>
                            <li>Receive data in through @Input</li>
                            <li>Pass data back out with @Output emitter</li>
                        </ul>
                    </section>

                    <section id="powers-input">
                        <h2>@Input</h2>
<pre><code data-trim>
@Input()
set attractions(attrs: ParkAttraction[]) {
    if (attrs) {
        this._attractions = attrs;
        this.attractionTree = this.dataToTree(attrs);
        if(this.created) {
            this.updateChart(this.attractionTree);
        }
    }
}  
</code></pre>
                        <aside class="notes">
                            Can also use ngOnChanges, which allows you to see old and current value.
                        </aside>
                    </section>

                    <section id="powers-output">
                        <h2>@Output</h2>
<pre><code class="groovy" data-trim>
@Output()
onArc: EventEmitter&lt;any&gt; = new EventEmitter&lt;any&gt;();

private clickArc(d: any): void {
    let clickedFilter = {};
    if(d.data.level == 'parkName') {
        clickedFilter['parkName'] = d.data.name;
    } else if(d.data.level == 'type') {
        clickedFilter['type'] = d.data.name;
        clickedFilter['parkName'] = d.parent.data.name;
    }
    if(clickedFilter['parkName']) {
        this.onArc.emit(clickedFilter);
    }
}
</code></pre>
                    </section>
                    
                    <section id="powers-html">
                        <h2>HTML Template</h2>
<pre><code data-trim>
<rhsun-park-sunburst
    [attractions]="attractions"
    [filters]="filters"
    (onArc)="onFilterArc($event)"></rhsun-park-sunburst>

<rhsun-filter-bar
    [arcFilter]="arcFilter"
    (onFilter)="onFilterBar($event)"></rhsun-filter-bar>
</code></pre>
                    </section>

                </section>

                <section id="code">
                    <section id="code-title">
                        <h1 class="section-title"><img src="/assets/img/vhs.png" class="no-style inline-header-logo" alt="vhs" title="vhs" /> Let's go to the gametape, Phil.</h1>
                    </section>

                    <section id="code-github">
                        <h2>Source</h2>
                        <p>
                            <a href="https://github.com/RHGeek/d3-ng-visual-awesomesauce/" title="code examples">https://github.com/RHGeek/d3-ng-visual-awesomesauce/example</a>
                        </p>
                    </section>
                </section>  

                <section id="wrap-up">
                    <img src="/assets/img/angularmix.png" class="no-style conf-logo-end--mix" title="AngularMix" />
                    <p>
                        Find me: <span title="twitter and github">@rhgeek</span>
                    </p>
                    <p>
                        <a href="https://rhgeek.github.io/" title="dev blog">https://rhgeek.github.io/</a>
                    </p>
                    <p>
                        Code: <a href="https://github.com/RHGeek/d3-ng-visual-awesomesauce" title="code examples">https://github.com/RHGeek/d3-ng-visual-awesomesauce</a>
                    </p>
                </section>


			</div>
		</div>

		<script src="node_modules/reveal.js/lib/js/head.min.js"></script>
		<script src="node_modules/reveal.js/js/reveal.js"></script>

		<script>
			// More info about config & dependencies:
			// - https://github.com/hakimel/reveal.js#configuration
			// - https://github.com/hakimel/reveal.js#dependencies
			Reveal.initialize({
				dependencies: [
					{ src: 'node_modules/reveal.js/plugin/markdown/marked.js' },
					{ src: 'node_modules/reveal.js/plugin/markdown/markdown.js' },
					{ src: 'node_modules/reveal.js/plugin/notes/notes.js', async: true },
					{ src: 'node_modules/reveal.js/plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } }
				]
			});
		</script>
	</body>
</html>
